1.3 ETL: load dimensions from raw_transactions
-- Products
INSERT INTO dim_product(product_id, product_name, category)
SELECT DISTINCT product_id, product_name, category
FROM raw_transactions rt
WHERE product_id IS NOT NULL
AND NOT EXISTS (SELECT 1 FROM dim_product d WHERE d.product_id = rt.product_id);


-- Regions
INSERT INTO dim_region(region_id, region_name)
SELECT DISTINCT region_id, region_name
FROM raw_transactions rt
WHERE region_id IS NOT NULL
AND NOT EXISTS (SELECT 1 FROM dim_region r WHERE r.region_id = rt.region_id);
